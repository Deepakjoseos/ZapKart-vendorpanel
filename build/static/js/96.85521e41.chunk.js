(this.webpackJsonpemilus=this.webpackJsonpemilus||[]).push([[96],{1425:function(e,t,a){"use strict";a.r(t);var r=a(22),s=a.n(r),n=a(75),c=a(70),i=a(0),o=a(36),l=a(47),u=a(143),m=a(147),d=a(617),p=a(618),b=a(626),h=a(563),f=a(140),j=a(687),x=a(85),O=a(173),v=a(40),g=a(3437),N=a(3434),y=a(318),w=a(2);t.default=function(){var e=Object(i.useState)(null),t=Object(c.a)(e,2),a=t[0],r=t[1],k=Object(i.useState)(!1),V=Object(c.a)(k,2),S=V[0],I=V[1],E=Object(i.useRef)(null),F=Object(i.useState)(!1),P=Object(c.a)(F,2),C=P[0],R=P[1],U=Object(i.useState)({}),T=Object(c.a)(U,2),A=T[0],q=T[1],D=Object(i.useState)(!1),L=Object(c.a)(D,2),z=L[0],J=L[1],Y=Object(i.useState)(!1),_=Object(c.a)(Y,2),B=_[0],W=_[1],G=Object(i.useState)(!1),H=Object(c.a)(G,2),K=H[0],M=H[1],Q=Object(l.g)(),X=Object(o.d)((function(e){return e.auth})).user,Z=Object(o.c)(),$=N.a({firstName:N.b().required("Required"),lastName:N.b().required("Required")});Object(i.useEffect)((function(){var e,t=function(){var e=Object(n.a)(s.a.mark((function e(){var t,a,r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(u.a)({url:"/vendors",method:"get"});case 3:a=e.sent,r=a.data,q({email:r.email||"",phone:(null===r||void 0===r||null===(t=r.phone)||void 0===t?void 0:t.slice(3))||"",firstName:r.firstName||"",lastName:r.lastName||"",displayImage:r.displayImage}),J(!0),X.emailVerified&&X.phoneVerified&&r.firstName&&r.lastName&&(m.a.success({message:"User Fully Authenticated"}),Q.replace("/")),X.emailVerified||M(!0),console.log(r,"profile-data"),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(X,"sjowww"),q({email:X.email||"",phone:(null===X||void 0===X||null===(n=X.phone)||void 0===n?void 0:n.slice(3))||"",firstName:X.firstName||"",lastName:X.lastName||"",displayImage:X.displayImage}),J(!1);case 17:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();console.log("the-user",X),t();var a=null===(e=x.a.currentUser.providerData)||void 0===e?void 0:e.find((function(e){return"password"===e.providerId}));W("password"===(null===a||void 0===a?void 0:a.providerId)),R(X.phoneVerified)}),[X]);var ee=function(){var e=Object(n.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.b.updateEmail(t);case 3:m.a.success({message:"Email Linked Success"}),e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),m.a.error({message:e.t0.message}),e.abrupt("return","error");case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(n.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("the-email",t);try{O.a.auth().currentUser.sendEmailVerification().then((function(){return m.a.success({message:"Email is sent to ".concat(t,". Click the link to complete your Verification.")}),!0}))}catch(a){m.a.error({message:a.message})}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(n.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.confirmationResult.confirm(a);case 3:e.sent,m.a.success({message:"Phone Number Linked Successfully"}),R(!0),I(!1),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),R(!1),I(!1),m.a.error({message:e.t0.message});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(n.a)(s.a.mark((function e(t,a){var r,n,c,i,o,l,u,d,p,b,h,f,j,x;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setSubmitting,a.resetForm,t.password,r=O.a.auth().currentUser,n=r.email,c=r.emailVerified,i=r.phoneNumber,console.log(c,"showww"),!i){e.next=64;break}if(n){e.next=14;break}return e.next=11,ee(t.email);case 11:if("error"!==e.sent){e.next=14;break}return e.abrupt("return");case 14:if(c){e.next=18;break}return o=n||t.email,e.next=18,te(o);case 18:if(l={firstName:t.firstName,lastName:t.lastName,displayImage:r.displayImage},z){e.next=42;break}return e.prev=20,e.next=23,y.a.createVendor(l);case 23:return u=e.sent,e.next=26,r.getIdTokenResult(!0);case 26:return d=e.sent,window.localStorage.setItem("auth_token",d.token),e.next=30,y.a.getProfile();case 30:return p=e.sent,b={firstName:p.firstName,lastName:p.lastName,email:p.email,phone:p.phone,displayImage:p.displayImage,emailVerified:c,phoneVerified:!!X.phoneNumber},e.next=34,Z(Object(v.a)({user:b,token:d.token}));case 34:u&&(m.a.success({message:"Authentication Success: Create"}),m.a.success({message:"User Fully Authenticated"}),Q.push("/")),e.next=40;break;case 37:e.prev=37,e.t0=e.catch(20),console.log("err",e.t0);case 40:e.next=62;break;case 42:return e.prev=42,e.next=45,y.a.editProfile(l);case 45:return h=e.sent,e.next=48,r.getIdTokenResult(!0);case 48:return f=e.sent,window.localStorage.setItem("auth_token",f.token),e.next=52,y.a.getProfile();case 52:return j=e.sent,x={firstName:j.firstName,lastName:j.lastName,email:j.email,phone:j.phone,displayImage:j.displayImage,emailVerified:c,phoneVerified:!!X.phoneNumber},e.next=56,Z(Object(v.a)({user:x,token:f.token}));case 56:h&&(m.a.success({message:"Authentication Success: Edit"}),m.a.success({message:"User Fully Authenticated"}),Q.push("/")),e.next=62;break;case 59:e.prev=59,e.t1=e.catch(42),console.log("err",e.t1);case 62:e.next=65;break;case 64:m.a.error({message:"You need To Verify your phone Number"});case 65:case"end":return e.stop()}}),e,null,[[20,37],[42,59]])})));return function(t,a){return e.apply(this,arguments)}}(),se=function(){var e=Object(n.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(O.a.auth().currentUser.email);case 2:Q.push("/");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsx)(w.Fragment,{children:K?Object(w.jsxs)(b.a,{title:"Email Verification Pending",children:[Object(w.jsx)("h3",{children:"You need to verify your Email Address"}),Object(w.jsx)(f.a,{type:"primary",htmlType:"button",className:"btn",onClick:se,children:"Verify Email Address"})]}):Object(w.jsxs)("div",{children:[Object(w.jsx)(g.d,{initialValues:A,onSubmit:re,enableReinitialize:!0,validationSchema:$,children:function(e){var t=e.touched,a=e.errors,r=e.isSubmitting,s=e.values;e.setFieldValue;return console.log(s,"values"),Object(w.jsx)(d.a,{gutter:16,children:Object(w.jsx)(p.a,{xs:24,sm:24,md:17,children:Object(w.jsx)(b.a,{title:"User Details",className:"p-3",children:Object(w.jsxs)(g.c,{children:[Object(w.jsxs)("div",{className:"mb-3",children:[Object(w.jsx)("label",{htmlFor:"firstName",children:"First Name"}),Object(w.jsx)(g.b,{as:h.a,className:"first-name-signup form-control",type:"text",name:"firstName",style:{border:"".concat(t.firstName&&a.firstName?"1px solid red":"")}}),Object(w.jsx)(g.a,{name:"firstName"})]}),Object(w.jsxs)("div",{className:"mb-3",children:[Object(w.jsx)("label",{htmlFor:"lastName",children:"Last Name"}),Object(w.jsx)(g.b,{as:h.a,type:"text",name:"lastName",className:"form-control",style:{border:"".concat(t.lastName&&a.lastName?"1px solid red":"")}}),Object(w.jsx)(g.a,{name:"lastName"})]}),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("label",{htmlFor:"phone",children:"Phone"}),Object(w.jsx)(g.b,{as:h.a,type:"phone",name:"phone",value:s.phone,className:"form-control",disabled:C,style:{border:"".concat(t.phone&&a.phone?"1px solid red":"")}}),Object(w.jsx)(g.a,{name:"phone"})]}),!C&&Object(w.jsx)("p",{onClick:function(){var e,t;10===(null===(e=s.phone)||void 0===e?void 0:e.length)?(t=s.phone,window.recaptchaVerifier||(window.recaptchaVerifier=new O.a.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible"})),window.recaptchaVerifier.render(),console.log(t,"heyyyy"),O.a.auth().currentUser.linkWithPhoneNumber("+91 ".concat(t),window.recaptchaVerifier).then((function(e){console.log(e,"plsss"),m.a.success({message:"Otp sent to your phone number"}),I(!0),window.confirmationResult=e})).catch((function(e){R(!1),I(!1),m.a.error({message:e.message}),console.log(e)}))):m.a.error({message:"Please Enter Valid Phone Number"})},style:{textDecoration:"underline",cursor:"pointer",marginBottom:"10px"},children:"Verify PhoneNumber"})]}),Object(w.jsxs)("div",{className:"mb-3",children:[Object(w.jsx)("label",{htmlFor:"lastName",children:"Email"}),Object(w.jsx)(g.b,{as:h.a,type:"email",name:"email",className:"form-control",disabled:B||X.emailVerified,style:{border:"".concat(t.email&&a.email?"1px solid red":"")}}),Object(w.jsx)(g.a,{name:"email"})]}),Object(w.jsx)("div",{children:Object(w.jsx)(f.a,{type:"primary",htmlType:"submit",className:"btn w-100 mb-3",disabled:r,children:"Submit"})})]})})})})}}),Object(w.jsxs)(j.a,{title:"Verify OTP",visible:S,onCancel:function(){return I(!1)},footer:null,destroyOnClose:!0,maskClosable:!1,children:[Object(w.jsx)("div",{className:"form-group",children:Object(w.jsx)(h.a,{type:"text",name:"otp",placeholder:"Enter OTP",className:"form-control mb-3",onChange:function(e){return r(e.target.value)}})}),Object(w.jsx)(f.a,{type:"primary",htmlType:"button",onClick:ae,children:"Submit"})]}),Object(w.jsx)("div",{id:"recaptcha-container",ref:E})]})})}}}]);
//# sourceMappingURL=96.85521e41.chunk.js.map